<!DOCTYPE html>
<html lang="en">
<head>
    <title>学生宿舍管理系统 | 学生管理</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/static/images/icons/favicon.ico">
    <link rel="apple-touch-icon" href="/static/images/icons/favicon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/images/icons/favicon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/images/icons/favicon-114x114.png">
    <!--Loading bootstrap css-->
	<link href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="http://apps.bdimg.com/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,300,700">
    <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Oswald:400,700,300">
    <link type="text/css" rel="stylesheet" href="/static/styles/jquery-ui-1.10.4.custom.min.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/font-awesome.min.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/animate.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/all.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/main.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/style-responsive.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/zabuto_calendar.min.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/pace.css">
    <link type="text/css" rel="stylesheet" href="/static/styles/jquery.news-ticker.css">
	<link type="text/css" rel="stylesheet" href="/static/styles/jplist-custom.css">
</head>
<body onload="loadpage()">
    <div>
        <!--BEGIN TOPBAR-->
        <nav id="topbar" role="navigation" style="margin-bottom: 0;" data-step="3" class="navbar navbar-default navbar-static-top">
            <div class="navbar-header">
                <a id="logo" class="navbar-brand"><span class="logo-text">学生宿舍管理系统</span></a>
			</div>
            <div class="topbar-main">
                <ul class="nav navbar navbar-top-links navbar-right mbn">
                    <li class="dropdown topbar-user"><a data-hover="dropdown" href="#" class="dropdown-toggle"><span class="hidden-xs">{{ user.username }}</span>&nbsp;<span class="caret"></span></a>
                        <ul class="dropdown-menu dropdown-user pull-right">
                            <li><a href="/logout"><i class="fa fa-key"></i>注销</a></li>
                        </ul>
				</ul>
            </div>
        </nav>
    </div>
        <!--END TOPBAR-->
    <div id="wrapper">
        <!--BEGIN SIDEBAR MENU-->
        <nav id="sidebar" role="navigation" data-step="2" data-intro="Template has &lt;b&gt;many navigation styles&lt;/b&gt;"
                data-position="right" class="navbar-default navbar-static-side">
            <div class="sidebar-collapse menu-scroll">
                 <ul id="side-menu" class="nav">
                     <div class="clearfix"></div>
                    <li><a href="/subpage/index/">
                    <span class="menu-title">个人首页</span></a>
                    </li>
                    <li><a href="/subpage/student/">
					<span class="menu-title">学生管理</span></a>
                    </li>
                    <li><a href="/subpage/discipline/">
					<span class="menu-title">违纪情况管理</span></a>
                    </li>
                    <li><a href="/subpage/dormitory/">
                    <span class="menu-title">宿舍管理</span></a>
                    </li>
                    <li><a href="/subpage/sanitation/">
                    <span class="menu-title">卫生情况管理</span></a>
                    </li>
                    <li><a href="/subpage/discipline_type/">
                    <span class="menu-title">规章制度管理</span></a>
                    </li>
                    <li><a href="/subpage/apartment/">
                    <span class="menu-title">公寓管理</span></a>
					</li>
					<li><a href="/subpage/administrator/">
                    <span class="menu-title">超级管理员</span></a>
					</li>					
                </ul>
            </div>
        </nav>
        <!--END SIDEBAR MENU-->  
          
        <div id="page-wrapper">
                <!--BEGIN TITLE & BREADCRUMB PAGE-->
                <div id="title-breadcrumb-option-demo" class="page-title-breadcrumb">
                    <div class="page-header pull-left">
                        <div class="page-title">
                            学生管理</div>
                    </div>
                    <div class="clearfix"></div>
                </div>
                <!--END TITLE & BREADCRUMB PAGE-->
				
				<!--BEGIN CONTENT-->
                <div class="page-content">
                    <div id="tab-general">
                        <div class="row mbl">
                            <div class="col-lg-12">                                
                                <div class="col-md-12">
                                    <div id="area-chart-spline" style="width: 100%; height: 300px; display: none;">
                                    </div>
                                </div>                                
                            </div>
							
                                <div id="grid-layout-table-1" class="box jplist">
                          
                                    <div class="jplist-panel box panel-top">
                                        <button type="button"  class="jplist-reset-btn btn btn-default" id="zhuce" data-toggle="modal">add</button>
										
                                        <div class="text-filter-box">
                                            <input  type="text" value="" id="id" placeholder="学号"  class="form-control"/>
                                        </div>
                                        <div class="text-filter-box">
                                            <input  type="text" value="" id="name" placeholder="姓名"  class="form-control"/>
                                        </div>
										<div class="text-filter-box">
                                            <input  type="text" value="" id="gender" placeholder="性别"  class="form-control"/>
                                        </div>
                                        <div class="text-filter-box">					
                                            <input  type="text" value="" id="dormitory_id" placeholder="宿舍号" class="form-control"/>
                                        </div>
										<div class="text-filter-box">
                                            <input  type="text" value=""  id="paid" placeholder="是否缴费" class="form-control"/>
                                        </div>
                                        <button type="button" onclick="inquire()" class="jplist-reset-btn btn btn-default">search</button>
                                    </div>
                                </div>
                        </div>
						
				

                        <div class="modal fade" id="myModal" role="dialog">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        <h4 class="modal-title" id="myModalLabel"><s class="icon-pencil"></s>&nbsp;添加</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form action="#" id="form" class="form-horizontal">
                                        
                                            <div class="form-group">
                                                <label for="exampleInputEmail1">学号</label>
                                                <input type="text" id="username2" class="form-control" placeholder="" name="id" />
                                            </div>
                                            <div class="form-group">
                                                <label for="exampleInputPassword1">姓名</label>
                                                <input type="text" class="form-control" name="name" />
                                            </div>
                                            <div class="form-group">
                                                <label for="exampleInputPassword1">是否缴费</label>
                                                <input type="text" class="form-control" name="paid" />
                                            </div>
                                            <div class="form-group">
                                                <label for="exampleInputEmail1">宿舍号</label>
                                                <input type="email" class="form-control" name="dormitory_id" />
                                            </div>
											<div class="form-group">
                                                <label for="exampleInputEmail1">性别</label>
                                                <input type="text" class="form-control" name="gender" />
                                            </div>
											<div class="form-group">
                                                <label for="exampleInputEmail1">入住时间</label>
                                                <input type="text" class="form-control" name="reside_date" />
                                            </div>
                                <div class="modal-footer">
                                        <button type="button" id="btnSave" class="btn btn-primary">提交</button>
                                        <button type="button" class="btn btn-info" data-dismiss="modal">关闭</button>
                                        <input type="reset" style="display: none;" />
                                   </div>
                            </form>
                                    </div>
                                </div>
                            </div>
                        </div>


                            <div class="modal fade" id="myModal2" role="dialog">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        <h4 class="modal-title" id="myModalLabel"><s class="icon-pencil"></s>&nbsp;添加</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form action="#" id="form2" class="form-horizontal">
                                        
                                            <div class="form-group">
                                                <label for="exampleInputEmail1">学号</label>
                                                <input type="text" " class="form-control" placeholder="" name="id" />
                                            </div>
                                            <div class="form-group">
                                                <label for="exampleInputEmail1">目的宿舍号</label>
                                                <input type="text" class="form-control" name="des_dormitory_id" />
                                            </div>

                                            </div>
                                <div class="modal-footer">
                                        <button type="button" id="btnSave2" class="btn btn-primary">提交</button>
                                        <button type="button" class="btn btn-info" data-dismiss="modal">关闭</button>
                                        <input type="reset" style="display: none;" />
                                   </div>
                            </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <table class="table table-striped table-advance table-hover">
                           <tbody>
                              <tr>
                                 <th><i class="icon_calendar"></i> 学号</th>
                                 <th><i class="icon_calendar"></i> 姓名</th>
                                 <th><i class="icon_calendar"></i> 性别</th>
                                 <th><i class="icon_calendar"></i> 宿舍号</th>
                                 <th><i class="icon_calendar"></i> 是否缴费</th>
                                 <th><i class="icon_calendar"></i> 入住时间</th>
								 <th><i class="icon_calendar"></i> 操作</th>
                              </tr>
                           </tbody>
                            <tbody id="ulul"></tbody>
                        </table>
            
                                
                    </div>
                </div>
				<!--END CONTENT-->
        </div> 
	</div>




	
    <script>
    $(document).ready(
            $('#btnSave2').click(
                function () {
                    $.ajax({
                            url: "/restapi/student/change_dormitory/",
                            type: "POST",
                            data: $('#form2').serialize(),
                            dataType: "JSON",
                            success: function () {
                                $('#myModal2').modal('hide');
                            },
                            error: function () {
                                alert('错了...');
                            }
                        })
                }
            ),
            $("#zhuce").click(
                    function () {
                        $('#form')[0].reset();// 重置form
                        $('#myModal').modal('show'); // 显示modal
                        $('.modal-title').text('添加学生信息'); // 设置title
                    }
            ),
			$("#xinxi").click(
                    function () {
                        $('#form')[0].reset();// 重置form
                        $('#myModal').modal('show'); // 显示modal
                        $('.modal-title').text('详细学生信息'); // 设置title
                    }
            ),
            $("#btnSave").click(
                    function () {
                        $.ajax({
                            url: "/restapi/student/add/",
                            type: "POST",
                            data: $('#form').serialize(),
                            dataType: "JSON",
                            success: function () {
                                $('#myModal').modal('hide');
                                alert(data["username"]+' '+'添加成功！');
                            },
                            error: function () {
                                alert('错了...');
                            }
                        })
                    }
            ));
    </script>
    <script src="/static/script/jquery-1.10.2.min.js"></script>
    <script src="/static/script/jquery-migrate-1.2.1.min.js"></script>
    <script src="/static/script/jquery-ui.js"></script>
    <script src="/static/script/bootstrap.min.js"></script>
    <script src="/static/script/bootstrap-hover-dropdown.js"></script>
    <script src="/static/script/html5shiv.js"></script>
    <script src="/static/script/respond.min.js"></script>
    <script src="/static/script/jquery.metisMenu.js"></script>
    <script src="/static/script/jquery.slimscroll.js"></script>
    <script src="/static/script/jquery.cookie.js"></script>
    <script src="/static/script/icheck.min.js"></script>
    <script src="/static/script/custom.min.js"></script>
    <script src="/static/script/jquery.news-ticker.js"></script>
    <script src="/static/script/jquery.menu.js"></script>
    <script src="/static/script/pace.min.js"></script>
    <script src="/static/script/holder.js"></script>
    <script src="/static/script/responsive-tabs.js"></script>
    <script src="/static/script/jquery.flot.js"></script>
    <script src="/static/script/jquery.flot.categories.js"></script>
    <script src="/static/script/jquery.flot.pie.js"></script>
    <script src="/static/script/jquery.flot.tooltip.js"></script>
    <script src="/static/script/jquery.flot.resize.js"></script>
    <script src="/static/script/jquery.flot.fillbetween.js"></script>
    <script src="/static/script/jquery.flot.stack.js"></script>
    <script src="/static/script/jquery.flot.spline.js"></script>
    <script src="/static/script/zabuto_calendar.min.js"></script>
    <script src="/static/script/index.js"></script>
    <script src="/static/script/highcharts.js"></script>
    <script src="/static/script/data.js"></script>
    <script src="/static/script/drilldown.js"></script>
    <script src="/static/script/exporting.js"></script>
    <script src="/static/script/highcharts-more.js"></script>
    <script src="/static/script/charts-highchart-pie.js"></script>
    <script src="/static/script/charts-highchart-more.js"></script>
    <script src="/static/script/modernizr.min.js"></script>
    <script src="/static/script/jplist.min.js"></script>
    <script src="/static/script/jplist.js"></script>
    <script src="/static/script/animation.js"></script>
    <!--CORE JAVASCRIPT-->
    <script src="/static/script/main.js"></script>

    <script>
        function loadpage()
        {
            $.ajax(
                {
                    url:"/restapi/student_table/",
                    type:"POST",
                    dataType:"JSON",
                    success: function (data) {
                       dataStudent=data
                       update(dataStudent) 
                     //    var htmlstr=""
                     // for(var i=0 ; i< data.student.length; i++){
                        
                     //    htmlstr=htmlstr+
                     //      '<tr><td>'+data.student[i].id +'</td><td>'+data.student[i].name +
                     //      '</td><td>'+data.student[i].gender+ '</td><td>'+data.student[i].dormitory_id +
                     //     '</td><td>'+data.student[i].paid +'</td><td>'+data.student[i].reside_date
                     //       +'</td> <td><div class="btn-group">'+
                     //        '<button type="button" class="btn btn-info btn-sm" data-toggle="modal">信息</button>'+
                     //       '<button type="button" class="btn btn-success btn-sm changeBtn" data-toggle="modal" id="xiugai">修改</button>'+
                     //       '<a class="btn btn-danger btn-sm" href="#">删除</a>'+
                     //        '</div> </td></tr>'
                     // }
                     //  $("#ulul").html(htmlstr)
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                           alert("数据错误");
                    }
                }
            )
        }
    </script>
    <script>
        function inquire()
        {
            $.ajax(
                {
                    url:"/restapi/student/inquire/",
                    type:"POST",
                    dataType:"JSON",
                    data:{"id":$("#id").val(),"name":$("#name").val(),"gender":$("#gender").val(),"dormitory_id":$("#dormitory_id").val(),"paid":$("#paid").val()},
                    success: function (data) {
                      dataStudent=data
                      update(dataStudent)
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                           alert("数据错误");
                    }
                }
            )
        }
    </script>
    <script>
        function changeF(changeId) {
            var student_id = 
                $("#"+changeId).parent().parent().parent().children("td:first").text();
            $('#form2')[0].reset();
            
            $('#myModal2 [name="id"]').val(student_id);
            $('#myModal2').modal('show');
        }
    </script>
    <script>
        var dataStudent;
        function update(dataStudent){
                    var htmlstr=""
                    // alert("ok")
                     for(var i=0 ; i< dataStudent.student.length; i++){
                        
                        htmlstr=htmlstr+
                          '<tr><td>'+dataStudent.student[i].id +'</td><td>'+dataStudent.student[i].name +
                          '</td><td>'+dataStudent.student[i].gender+ '</td><td>'+dataStudent.student[i].dormitory_id +
                         '</td><td>'+dataStudent.student[i].paid +'</td><td>'+dataStudent.student[i].reside_date
                           +'</td> <td><div class="btn-group">'+
                           '<button type="button" class="btn btn-success btn-sm changeBtn" data-toggle="modal" id="changeId-'+i+'" onclick=changeF(this.id)>修改</button>'+
                           '<a class="btn btn-danger btn-sm" href="#">删除</a>'+
                            '</div> </td></tr>'
                     }
                      $("#ulul").html(htmlstr)

        }
    </script>>
</body>
</html>
